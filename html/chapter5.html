<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>第5章：网格处理算法</title>
    <link rel="stylesheet" href="./assets/style.css">
    <link rel="stylesheet" href="./assets/highlight.css">
    <script src="./assets/script.js" defer></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']],
                processEscapes: false,
                packages: {'[+]': ['noerrors', 'ams']}
            },
            options: {
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process'
            },
            loader: {
                load: ['[tex]/noerrors', '[tex]/ams']
            }
        };
    </script>
</head>
<body>
    <div class="container">
        <nav id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <h3>目录</h3>
                <button id="sidebar-toggle" class="sidebar-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
            <ul class="nav-list"><li class=""><a href="./index.html">3D打印中的数学原理与计算方法</a></li><li class=""><a href="./chapter1.html">第1章：几何表示与变换</a></li><li class=""><a href="./chapter2.html">第2章：微分几何与离散算子</a></li><li class=""><a href="./chapter3.html">第3章：计算共形几何</a></li><li class=""><a href="./chapter4.html">第4章：计算拓扑与同调</a></li><li class="active"><a href="./chapter5.html">第5章：网格处理算法</a></li><li class=""><a href="./chapter6.html">第6章：有限元方法与结构分析</a></li><li class=""><a href="./chapter7.html">第7章：拓扑优化基础</a></li><li class=""><a href="./chapter8.html">第8章：高级拓扑优化</a></li><li class=""><a href="./chapter9.html">第9章：切片算法与支撑生成</a></li><li class=""><a href="./chapter10.html">第10章：路径规划与填充</a></li><li class=""><a href="./chapter11.html">第11章：误差分析与补偿</a></li><li class=""><a href="./chapter12.html">第12章：流体仿真基础</a></li><li class=""><a href="./chapter13.html">第13章：多相流与传热</a></li><li class=""><a href="./chapter14.html">第14章：多视图几何</a></li><li class=""><a href="./chapter15.html">第15章：神经隐式表示</a></li><li class=""><a href="./chapter16.html">第16章：3D Gaussian Splatting</a></li><li class=""><a href="./chapter17.html">第17章：可微渲染基础</a></li><li class=""><a href="./chapter18.html">第18章：高级可微渲染与逆向问题</a></li><li class=""><a href="./chapter19.html">第19章：符号几何与程序化建模</a></li><li class=""><a href="./chapter20.html">第20章：神经程序合成</a></li><li class=""><a href="./chapter21.html">第21章：深度生成模型</a></li><li class=""><a href="./chapter22.html">第22章：形状分析与检索</a></li><li class=""><a href="./chapter23.html">第23章：多材料与4D打印</a></li><li class=""><a href="./chapter24.html">第24章：仿生设计与自然算法</a></li><li class=""><a href="./chapter25.html">第25章：逆向问题与参数估计</a></li><li class=""><a href="./chapter26.html">第26章：实时仿真与数字孪生</a></li><li class=""><a href="./chapter27.html">第27章：常用工具与库</a></li><li class=""><a href="./CLAUDE.html">Untitled</a></li></ul>
        </nav>
        
        <main class="content">
            <article>
                <h1 id="5">第5章：网格处理算法</h1>
<p>网格处理是3D打印工作流中的核心环节，直接影响打印质量、效率和可制造性。本章深入探讨网格简化、重新网格化、修复、细分和变形等关键算法的数学原理。我们将从误差度量、能量优化、微分几何等角度分析这些算法，强调数值稳定性和计算效率，并通过大量练习帮助读者掌握算法设计和分析技巧。</p>
<h2 id="51-qem">5.1 网格简化：QEM、渐进网格</h2>
<p>网格简化旨在减少网格复杂度同时保持几何特征。这在3D打印中至关重要：降低切片计算量、减少文件大小、适应打印精度限制。</p>
<h3 id="511-qem">5.1.1 二次误差度量（QEM）</h3>
<h4 id="_1">基本原理</h4>
<p>对于顶点 $\mathbf{v}$，定义其到相关平面集合的二次误差：</p>
<p>$$E(\mathbf{v}) = \sum_{p \in \text{planes}(\mathbf{v})} (\mathbf{n}_p^T \mathbf{v} + d_p)^2$$
其中平面 $p$ 由法向量 $\mathbf{n}_p$ 和距离 $d_p$ 定义。</p>
<p>这个误差度量的几何意义是顶点到其相关平面的距离平方和。对于网格顶点，相关平面通常是其相邻三角形所在的平面。平面方程 $\mathbf{n}^T\mathbf{x} + d = 0$ 中，$\mathbf{n}$ 是单位法向量，$d$ 是原点到平面的有向距离。</p>
<h4 id="_2">矩阵形式</h4>
<p>将误差改写为二次形式：
$$E(\mathbf{v}) = \mathbf{v}^T \mathbf{Q} \mathbf{v} + 2\mathbf{b}^T \mathbf{v} + c$$
其中：</p>
<ul>
<li>$\mathbf{Q} = \sum_p \mathbf{n}_p \mathbf{n}_p^T$ （$3 \times 3$ 矩阵）</li>
<li>$\mathbf{b} = \sum_p d_p \mathbf{n}_p$ （$3 \times 1$ 向量）</li>
<li>$c = \sum_p d_p^2$ （标量）</li>
</ul>
<p>更紧凑地，可以使用齐次坐标表示：
$$E(\tilde{\mathbf{v}}) = \tilde{\mathbf{v}}^T \mathbf{K}_p \tilde{\mathbf{v}}$$
其中 $\tilde{\mathbf{v}} = [\mathbf{v}^T, 1]^T$，基础二次矩阵：
$$\mathbf{K}_p = \begin{pmatrix}
\mathbf{n}\mathbf{n}^T &amp; d\mathbf{n} \\
d\mathbf{n}^T &amp; d^2
\end{pmatrix} = \begin{pmatrix}
n_x^2 &amp; n_xn_y &amp; n_xn_z &amp; dn_x \\
n_xn_y &amp; n_y^2 &amp; n_yn_z &amp; dn_y \\
n_xn_z &amp; n_yn_z &amp; n_z^2 &amp; dn_z \\
dn_x &amp; dn_y &amp; dn_z &amp; d^2
\end{pmatrix}$$
顶点的总误差矩阵是所有相关平面误差矩阵的和：$\mathbf{K} = \sum_p \mathbf{K}_p$</p>
<h4 id="_3">边收缩操作</h4>
<p>对于边 $(v_1, v_2) \to \bar{v}$，新顶点的误差矩阵为：
$$\mathbf{Q}_{\bar{v}} = \mathbf{Q}_{v_1} + \mathbf{Q}_{v_2}$$
最优位置通过求解获得：
$$\bar{\mathbf{v}} = -\mathbf{Q}^{-1} \mathbf{b}$$
当 $\mathbf{Q}$ 奇异时，使用伪逆或选择端点/中点。</p>
<h4 id="_4">最优位置的推导</h4>
<p>最小化误差 $E(\mathbf{v})$ 需要满足：
$$\nabla E = 2\mathbf{Q}\mathbf{v} + 2\mathbf{b} = \mathbf{0}$$
因此最优位置为：
$$\mathbf{v}^* = -\mathbf{Q}^{-1}\mathbf{b}$$
在齐次坐标下，最优位置满足：
$$\begin{pmatrix}
\mathbf{Q} &amp; \mathbf{b} \\
\mathbf{b}^T &amp; c
\end{pmatrix} \begin{pmatrix}
\mathbf{v}^* \\
1
\end{pmatrix} = \begin{pmatrix}
\mathbf{0} \\
1
\end{pmatrix}$$
当 $\mathbf{Q}$ 奇异（秩 &lt; 3）时，解不唯一，表示最优位置在一条线或平面上。实践中的处理策略：</p>
<ol>
<li><strong>线性搜索</strong>：在边 $(v_1, v_2)$ 上搜索最小误差点</li>
<li><strong>中点选择</strong>：简单选择 $(v_1 + v_2)/2$</li>
<li><strong>端点选择</strong>：选择误差较小的端点</li>
<li><strong>伪逆求解</strong>：使用Moore-Penrose伪逆</li>
</ol>
<h4 id="_5">特征保持</h4>
<p>通过加权保持尖锐特征：
$$\mathbf{Q}_{\text{weighted}} = \mathbf{Q}_{\text{basic}} + w_{\text{feature}} \cdot \mathbf{Q}_{\text{feature}}$$
其中特征矩阵基于二面角：
$$w_{\text{feature}} = \begin{cases}
\lambda \cdot (1 - \cos\theta) &amp; \text{if } \theta &gt; \theta_{\text{sharp}} \\
0 &amp; \text{otherwise}
\end{cases}$$</p>
<h4 id="_6">边界和约束处理</h4>
<p>对于边界边，构造虚拟约束平面：
$$\mathbf{K}_{\text{boundary}} = w_{\text{boundary}} \cdot \begin{pmatrix}
\mathbf{t}\mathbf{t}^T &amp; \mathbf{0} \\
\mathbf{0}^T &amp; 0
\end{pmatrix}$$
其中 $\mathbf{t}$ 是边界边的切向量，$w_{\text{boundary}}$ 是边界保持权重（通常设为 $10^3$ 到 $10^6$）。</p>
<p>对于特征边（如折痕），添加垂直于特征的约束平面：
$$\mathbf{K}_{\text{crease}} = w_{\text{crease}} \cdot \sum_{i} \mathbf{K}_{\perp,i}$$
其中 $\mathbf{K}_{\perp,i}$ 是垂直于特征边的约束平面。</p>
<h3 id="512-progressive-meshes">5.1.2 渐进网格（Progressive Meshes）</h3>
<h4 id="_7">边收缩序列</h4>
<p>渐进网格通过记录边收缩序列实现多分辨率表示：
$$M^n \xrightarrow{\text{ecol}_{n-1}} M^{n-1} \xrightarrow{\text{ecol}_{n-2}} \cdots \xrightarrow{\text{ecol}_0} M^0$$
逆操作（顶点分裂）：
$$M^0 \xrightarrow{\text{vsplit}_0} M^1 \xrightarrow{\text{vsplit}_1} \cdots \xrightarrow{\text{vsplit}_{n-1}} M^n$$</p>
<h4 id="_8">几何形态插值</h4>
<p>参数化边收缩 $\text{ecol}(v_1, v_2, t)$：
$$\mathbf{v}(t) = (1-t)\mathbf{v}_1 + t\mathbf{v}_2$$
支持连续LOD（细节层次）：
$$M(t) = M^{\lfloor t \rfloor} + \text{geomorph}(t - \lfloor t \rfloor)$$</p>
<h4 id="_9">视相关简化</h4>
<p>基于视点的误差度量：
$$E_{\text{view}}(\mathbf{v}) = E_{\text{geometric}}(\mathbf{v}) \cdot \psi(\mathbf{v}, \mathbf{e})$$
其中 $\psi$ 是视相关权重函数：
$$\psi(\mathbf{v}, \mathbf{e}) = \frac{\max(0, \mathbf{n} \cdot (\mathbf{e} - \mathbf{v}))}{|\mathbf{e} - \mathbf{v}|^2}$$</p>
<h3 id="513">5.1.3 拓扑约束</h3>
<h4 id="_10">连通性保持</h4>
<p>防止拓扑改变的链接条件（Link Condition）：
$$\text{link}(v_1) \cap \text{link}(v_2) = \text{link}(\text{edge}(v_1, v_2))$$
其中：</p>
<ul>
<li>$\text{link}(v)$ = $\{w : (v,w) \in E\}$ 是顶点 $v$ 的链接</li>
<li>$\text{link}(e)$ = $\{w : (v_1,w) \in F \wedge (v_2,w) \in F\}$ 是边 $e=(v_1,v_2)$ 的链接</li>
</ul>
<p>链接条件保证边收缩不改变网格的拓扑类型（亏格、边界数、连通分量数）。</p>
<h4 id="_11">流形性检查</h4>
<p>确保简化后保持2-流形性质：</p>
<ul>
<li>每条边最多被两个三角形共享</li>
<li>顶点的1-邻域同胚于圆盘或半圆盘</li>
</ul>
<p>具体检查包括：</p>
<ol>
<li><strong>边流形性</strong>：边 $(v_1, v_2)$ 收缩后，检查新顶点 $\bar{v}$ 的每条边是否满足流形条件</li>
<li><strong>顶点流形性</strong>：$\bar{v}$ 的1-邻域应形成单个连通的扇形或圆盘</li>
<li><strong>面翻转检测</strong>：确保收缩不会导致三角形法向翻转
$$\text{valid} = \bigwedge_{f \in N(\bar{v})} (\mathbf{n}_f^{\text{before}} \cdot \mathbf{n}_f^{\text{after}} &gt; \epsilon)$$</li>
</ol>
<h3 id="514">5.1.4 数值稳定性</h3>
<h4 id="_12">条件数分析</h4>
<p>矩阵 $\mathbf{Q}$ 的条件数：
$$\kappa(\mathbf{Q}) = \frac{\lambda_{\max}}{\lambda_{\min}}$$
当 $\kappa &gt; 10^6$ 时使用正则化：
$$\mathbf{Q}_{\text{reg}} = \mathbf{Q} + \epsilon \mathbf{I}$$
其中 $\epsilon$ 的选择策略：</p>
<ul>
<li>绝对正则化：$\epsilon = 10^{-6}$</li>
<li>相对正则化：$\epsilon = 10^{-6} \cdot \text{trace}(\mathbf{Q})/3$</li>
<li>自适应正则化：$\epsilon = \max(10^{-8}, 10^{-3} \cdot \lambda_{\min})$</li>
</ul>
<h4 id="_13">浮点精度考虑</h4>
<p>使用Kahan求和减少累积误差：</p>
<div class="codehilite"><pre><span></span><code><span class="k">proc</span><span class="nv">edure</span><span class="w"> </span><span class="nv">KahanSum</span><span class="p">(</span><span class="nv">values</span><span class="p">[])</span>
<span class="w">  </span><span class="nf">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span>
<span class="w">  </span><span class="nf">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="err">补偿项</span>
<span class="w">  </span><span class="nf">for</span><span class="w"> </span><span class="nv">value</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">values</span><span class="p">:</span>
<span class="w">    </span><span class="nf">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">value</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">c</span>
<span class="w">    </span><span class="nf">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">y</span>
<span class="w">    </span><span class="nf">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nv">t</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">sum</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">y</span>
<span class="w">    </span><span class="nf">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">t</span>
<span class="w">  </span><span class="nf">return</span><span class="w"> </span><span class="nv">sum</span>
</code></pre></div>

<p>对于QEM矩阵累加，使用双精度（double）而非单精度（float），并在关键计算中使用扩展精度。</p>
<h4 id="_14">优先队列更新策略</h4>
<p>使用懒惰删除避免频繁的堆重构：</p>
<ol>
<li><strong>时间戳方法</strong>：每个边存储时间戳，过期的边在出队时忽略</li>
<li><strong>标记方法</strong>：标记已删除的边，出队时跳过</li>
<li><strong>延迟更新</strong>：批量更新受影响的边</li>
</ol>
<h2 id="52">5.2 重新网格化：各向同性、各向异性</h2>
<p>重新网格化改善网格质量，对3D打印的结构分析和切片效率至关重要。</p>
<h3 id="521">5.2.1 各向同性重新网格化</h3>
<h4 id="delaunay">Delaunay三角化</h4>
<p>最大化最小角准则：
$$\max \min_{T \in \mathcal{T}} \min_{i=1,2,3} \angle_i(T)$$
空圆性质：三角形外接圆内不包含其他顶点。</p>
<p><strong>Delaunay三角化的数学性质</strong>：</p>
<ol>
<li><strong>最大化最小角</strong>：在所有可能的三角化中，Delaunay三角化最大化最小角</li>
<li><strong>对偶性</strong>：Delaunay三角化是Voronoi图的对偶</li>
<li><strong>唯一性</strong>：当没有四点共圆时，Delaunay三角化唯一</li>
<li><strong>凸包性质</strong>：Delaunay三角化的边界是点集的凸包</li>
</ol>
<p><strong>增量插入算法</strong>（Bowyer-Watson）：</p>
<ol>
<li>初始化超级三角形包含所有点</li>
<li>对每个点 $p$：
   - 找到包含 $p$ 的三角形
   - 删除所有外接圆包含 $p$ 的三角形（坏三角形）
   - 重新三角化形成的空腔</li>
<li>删除与超级三角形相关的三角形</li>
</ol>
<p>时间复杂度：$O(n \log n)$ 期望，$O(n^2)$ 最坏情况</p>
<h4 id="voronoicvt">质心Voronoi图（CVT）</h4>
<p>Lloyd迭代优化能量函数：
$$E_{\text{CVT}} = \sum_{i=1}^n \int_{\Omega_i} |\mathbf{x} - \mathbf{c}_i|^2 d\mathbf{x}$$
其中 $\Omega_i$ 是Voronoi区域，$\mathbf{c}_i$ 是质心：
$$\mathbf{c}_i = \frac{\int_{\Omega_i} \mathbf{x} d\mathbf{x}}{\int_{\Omega_i} d\mathbf{x}}$$
<strong>Lloyd算法</strong>：</p>
<ol>
<li>初始化种子点 $\{\mathbf{p}_i\}$</li>
<li>重复直到收敛：
   - 计算Voronoi图 $\{\Omega_i\}$
   - 更新种子点为质心：$\mathbf{p}_i \leftarrow \mathbf{c}_i$</li>
</ol>
<p><strong>收敛性分析</strong>：</p>
<ul>
<li>Lloyd算法单调降低CVT能量</li>
<li>收敛到局部最小值（不保证全局最优）</li>
<li>收敛速度：线性收敛，收敛率依赖于初始配置</li>
</ul>
<p><strong>加速技术</strong>：</p>
<ol>
<li>
<p><strong>准牛顿方法</strong>（L-BFGS）：
$$\mathbf{p}^{(k+1)} = \mathbf{p}^{(k)} - \alpha \mathbf{H}^{-1} \nabla E$$
其中 $\mathbf{H}$ 是近似Hessian矩阵</p>
</li>
<li>
<p><strong>多重网格方法</strong>：
   - 在粗网格上求解
   - 插值到细网格
   - 局部优化</p>
</li>
<li>
<p><strong>GPU并行化</strong>：
   - 并行计算Voronoi区域
   - 并行质心计算</p>
</li>
</ol>
<h4 id="_15">边翻转优化</h4>
<p>通过边翻转最大化质量度量：
$$Q(T) = \frac{A}{\sum_{i=1}^3 l_i^2}$$
其中 $A$ 是三角形面积，$l_i$ 是边长。</p>
<p><strong>常用质量度量</strong>：</p>
<ol>
<li>
<p><strong>半径比（Radius Ratio）</strong>：
$$Q_{RR} = \frac{r_{in}}{r_{circ}}$$
其中 $r_{in}$ 是内切圆半径，$r_{circ}$ 是外接圆半径</p>
</li>
<li>
<p><strong>角度偏差（Angle Deviation）</strong>：
$$Q_{AD} = \max_i |\angle_i - 60°|$$</p>
</li>
<li>
<p><strong>边长比（Edge Ratio）</strong>：
$$Q_{ER} = \frac{\max_i l_i}{\min_i l_i}$$
<strong>边翻转准则</strong>：</p>
</li>
</ol>
<p>对于共享边 $e$ 的三角形对 $(T_1, T_2)$，翻转为 $(T_1', T_2')$ 当且仅当：
$$Q(T_1') + Q(T_2') &gt; Q(T_1) + Q(T_2) + \epsilon$$
<strong>局部Delaunay准则</strong>：</p>
<p>边 $e$ 满足局部Delaunay当且仅当：
$$\angle_{\text{opposite}}^1 + \angle_{\text{opposite}}^2 \leq \pi$$
不满足时进行翻转。</p>
<h3 id="522">5.2.2 各向异性重新网格化</h3>
<h4 id="_16">度量张量场</h4>
<p>定义黎曼度量 $\mathbf{M}(\mathbf{x})$：
$$\mathbf{M} = \mathbf{R}^T \begin{pmatrix} h_1^{-2} &amp; 0 \\ 0 &amp; h_2^{-2} \end{pmatrix} \mathbf{R}$$
其中 $\mathbf{R}$ 是主方向旋转矩阵，$h_1, h_2$ 是期望尺寸。</p>
<p><strong>度量张量的几何意义</strong>：</p>
<p>在度量 $\mathbf{M}$ 下，单位圆变换为椭圆：
$$\mathbf{x}^T \mathbf{M} \mathbf{x} = 1$$
椭圆的主轴方向是 $\mathbf{R}$ 的列向量，主轴长度是 $h_1, h_2$。</p>
<p><strong>度量插值</strong>：</p>
<p>给定两个度量 $\mathbf{M}_1, \mathbf{M}_2$，线性插值：
$$\mathbf{M}(t) = (1-t)\mathbf{M}_1 + t\mathbf{M}_2$$
对数插值（保持正定性）：
$$\mathbf{M}(t) = \exp((1-t)\log\mathbf{M}_1 + t\log\mathbf{M}_2)$$
其中矩阵对数通过特征分解计算：
$$\log\mathbf{M} = \mathbf{V}\log\mathbf{\Lambda}\mathbf{V}^T$$</p>
<h4 id="_17">曲率自适应</h4>
<p>基于主曲率构造度量：
$$h_i = \min\left(\frac{\epsilon}{|\kappa_i|}, h_{\max}\right)$$
其中 $\epsilon$ 是近似误差容限。</p>
<p><strong>Hessian度量</strong>：</p>
<p>基于曲面的二阶导数构造度量：
$$\mathbf{H} = \begin{pmatrix}
\frac{\partial^2 f}{\partial x^2} &amp; \frac{\partial^2 f}{\partial x \partial y} \\
\frac{\partial^2 f}{\partial x \partial y} &amp; \frac{\partial^2 f}{\partial y^2}
\end{pmatrix}$$
度量张量：
$$\mathbf{M} = \frac{1}{\epsilon^{2/3}} |\mathbf{H}|^{2/3}$$
其中 $|\mathbf{H}| = \mathbf{V}|\mathbf{\Lambda}|\mathbf{V}^T$，$|\lambda_i|$ 取绝对值。</p>
<p><strong>各向异性误差估计</strong>：</p>
<p>线性插值误差的上界：
$$|f - \Pi_h f|_{L^\infty} \leq C \max_{T} \max_{\mathbf{e} \in T} \mathbf{e}^T \mathbf{H} \mathbf{e} \cdot |\mathbf{e}|^2$$
其中 $\Pi_h$ 是分片线性插值算子。</p>
<h4 id="delaunay_1">各向异性Delaunay</h4>
<p>在度量空间中的Delaunay条件：
$$\text{incircle}_{\mathbf{M}}(p, q, r, s) = \det\begin{pmatrix}
p_x - s_x &amp; p_y - s_y &amp; |\mathbf{p} - \mathbf{s}|_{\mathbf{M}}^2 \\
q_x - s_x &amp; q_y - s_y &amp; |\mathbf{q} - \mathbf{s}|_{\mathbf{M}}^2 \\
r_x - s_x &amp; r_y - s_y &amp; |\mathbf{r} - \mathbf{s}|_{\mathbf{M}}^2
\end{pmatrix} &gt; 0$$</p>
<h3 id="523">5.2.3 特征对齐</h3>
<h4 id="_18">主曲率方向场</h4>
<p>计算形状算子 $\mathbf{S}$：
$$\mathbf{S} = -\mathbf{dN} \cdot \mathbf{dX}^{-1}$$
特征值分解得主曲率和主方向。</p>
<p><strong>离散形状算子</strong>：</p>
<p>对于顶点 $v$，使用最小二乘拟合：
$$\min_{\mathbf{S}} \sum_{i \in N(v)} w_i |\mathbf{S}(\mathbf{x}_i - \mathbf{x}_v) - (\mathbf{n}_i - \mathbf{n}_v)|^2$$
权重选择：</p>
<ul>
<li>均匀权重：$w_i = 1$</li>
<li>余切权重：$w_i = \cot\alpha_i + \cot\beta_i$</li>
<li>面积权重：$w_i = A_i/3$</li>
</ul>
<p>解为：
$$\mathbf{S} = \left(\sum_i w_i (\mathbf{x}_i - \mathbf{x}_v)(\mathbf{n}_i - \mathbf{n}_v)^T\right) \left(\sum_i w_i (\mathbf{x}_i - \mathbf{x}_v)(\mathbf{x}_i - \mathbf{x}_v)^T\right)^{-1}$$
<strong>主方向的奇点</strong>：</p>
<p>脐点（umbilical point）：$\kappa_1 = \kappa_2$，主方向不确定</p>
<p>奇点指数：
$$\text{index} = \frac{1}{2\pi} \oint_{\gamma} d\theta$$
其中 $\theta$ 是主方向场的角度。</p>
<h4 id="_19">交叉场引导</h4>
<p>4-RoSy场（4-旋转对称场）：
$$\mathbf{u}(\mathbf{x}) = e^{i\theta(\mathbf{x})}$$
满足边界对齐约束：
$$\mathbf{u}|_{\partial\Omega} \parallel \mathbf{t}|_{\partial\Omega}$$</p>
<h3 id="524">5.2.4 全局参数化</h3>
<h4 id="_20">整数网格映射</h4>
<p>寻找参数化 $f: M \to \mathbb{R}^2$，使得：
$$\nabla f \approx \mathbf{u}$$
通过Poisson方程求解：
$$\Delta f = \nabla \cdot \mathbf{u}$$</p>
<h4 id="_21">奇点放置</h4>
<p>使用Index理论确定奇点：
$$\sum_{v \in V} \text{index}(v) = \chi(M)$$
其中 $\chi(M)$ 是欧拉特征数。</p>
<h2 id="53">5.3 网格修复：孔洞填充、自相交检测</h2>
<p>3D扫描和建模常产生缺陷网格，修复算法是打印前处理的必要步骤。</p>
<h3 id="531">5.3.1 孔洞检测与分类</h3>
<h4 id="_22">边界环提取</h4>
<p>识别边界边（只属于一个三角形）：
$$\partial M = \{e \in E : |\text{faces}(e)| = 1\}$$
通过深度优先搜索提取连通边界环。</p>
<p><strong>边界环算法</strong>：</p>
<div class="codehilite"><pre><span></span><code><span class="k">proc</span><span class="nv">edure</span><span class="w"> </span><span class="nv">ExtractBoundaryLoops</span><span class="p">(</span><span class="nv">mesh</span><span class="p">)</span>
<span class="w">  </span><span class="nf">boundary_edges</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">找到所有边界边</span>
<span class="w">  </span><span class="nf">visited</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">初始化为</span><span class="nv">false</span>
<span class="w">  </span><span class="nf">loops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">  </span><span class="nf">for</span><span class="w"> </span><span class="nv">e</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">boundary_edges</span><span class="p">:</span>
<span class="w">    </span><span class="nf">if</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">visited</span><span class="p">[</span><span class="nv">e</span><span class="p">]:</span>
<span class="w">      </span><span class="nf">loop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="w">      </span><span class="nf">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">e</span>
<span class="w">      </span><span class="nf">while</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">visited</span><span class="p">[</span><span class="nv">current</span><span class="p">]:</span>
<span class="w">        </span><span class="nf">visited</span><span class="p">[</span><span class="nv">current</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">true</span>
<span class="w">        </span><span class="nf">loop.append</span><span class="p">(</span><span class="nv">current.vertex</span><span class="p">)</span>
<span class="w">        </span><span class="nf">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">找到下一条未访问的边界边</span>
<span class="w">      </span><span class="nf">loops.append</span><span class="p">(</span><span class="nv">loop</span><span class="p">)</span>

<span class="w">  </span><span class="nf">return</span><span class="w"> </span><span class="nv">loops</span>
</code></pre></div>

<p><strong>半边结构优化</strong>：</p>
<p>使用半边结构可以 $O(1)$ 时间找到下一条边界边：</p>
<div class="codehilite"><pre><span></span><code>next_boundary = current.twin.next
while next_boundary.twin != null:
  next_boundary = next_boundary.twin.next
</code></pre></div>

<h4 id="_23">孔洞特征分析</h4>
<p>计算边界环的几何特征：</p>
<ul>
<li>周长：$L = \sum_{e \in \partial} |e|$</li>
<li>面积（投影）：$A = \frac{1}{2}|\sum_{i} (\mathbf{x}_i \times \mathbf{x}_{i+1})|$</li>
<li>平面性：$\sigma = \frac{\lambda_3}{\lambda_1 + \lambda_2 + \lambda_3}$</li>
</ul>
<p>其中 $\lambda_i$ 是边界点协方差矩阵的特征值。</p>
<h3 id="532">5.3.2 孔洞填充算法</h3>
<h4 id="_24">最小面积三角化</h4>
<p>动态规划求解最小面积：
$$A(i, j) = \min_{i &lt; k &lt; j} \{A(i, k) + A(k, j) + A_{\triangle}(v_i, v_k, v_j)\}$$
时间复杂度 $O(n^3)$。</p>
<p><strong>动态规划详细推导</strong>：</p>
<p>定义 $A(i, j)$ 为顶点 $v_i$ 到 $v_j$ 的子多边形的最小三角化面积。</p>
<p>边界条件：</p>
<ul>
<li>$A(i, i+1) = 0$ （相邻顶点无需三角化）</li>
<li>$A(i, i+2) = A_{\triangle}(v_i, v_{i+1}, v_{i+2})$</li>
</ul>
<p>递推关系：
对于 $j - i &gt; 2$，枚举中间顶点 $k$，形成三角形 $(v_i, v_k, v_j)$。</p>
<p><strong>三角形面积计算</strong>：</p>
<p>使用叉积：
$$A_{\triangle} = \frac{1}{2}|(\mathbf{v}_k - \mathbf{v}_i) \times (\mathbf{v}_j - \mathbf{v}_i)|$$
或使用Heron公式：
$$A = \sqrt{s(s-a)(s-b)(s-c)}$$
其中 $s = (a+b+c)/2$ 是半周长。</p>
<h4 id="advancing-front">推进波前法（Advancing Front）</h4>
<p>迭代添加三角形，选择最优候选：
$$\text{score}(v_i, v_j, v_k) = \alpha \cdot \text{angle} + \beta \cdot \text{area} + \gamma \cdot \text{normal}$$
角度项倾向等边三角形：
$$\text{angle} = \sum_{i=1}^3 |\angle_i - 60°|$$</p>
<h4 id="poisson">Poisson曲面重建</h4>
<p>求解Poisson方程：
$$\Delta \chi = \nabla \cdot \vec{V}$$
其中 $\vec{V}$ 是从采样点法向构造的向量场，$\chi$ 是指示函数。</p>
<p>使用八叉树自适应离散化：
$$\chi(\mathbf{x}) = \sum_{o \in \text{octree}} c_o B_o(\mathbf{x})$$
其中 $B_o$ 是基函数。</p>
<p><strong>向量场构造</strong>：</p>
<p>从有向点云 $\{(\mathbf{p}_i, \mathbf{n}_i)\}$ 构造向量场：
$$\vec{V}(\mathbf{x}) = \sum_i W_i(\mathbf{x}) \mathbf{n}_i$$
其中权重函数：
$$W_i(\mathbf{x}) = \frac{1}{|\mathbf{x} - \mathbf{p}_i|^2} \cdot G_{\sigma}(|\mathbf{x} - \mathbf{p}_i|)$$
$G_{\sigma}$ 是高斯核。</p>
<p><strong>八叉树基函数</strong>：</p>
<p>使用三维B样条作为基函数：
$$B_o(\mathbf{x}) = B\left(\frac{x - c_x}{w}\right) B\left(\frac{y - c_y}{w}\right) B\left(\frac{z - c_z}{w}\right)$$
其中 $(c_x, c_y, c_z)$ 是八叉树节点中心，$w$ 是节点宽度。</p>
<p><strong>离散Laplacian</strong>：</p>
<p>在八叉树上的离散Laplacian：
$$[\mathbf{L}]_{ij} = \int_{\Omega} \nabla B_i \cdot \nabla B_j d\mathbf{x}$$
由于B样条的局部支撑性，矩阵是稀疏的。</p>
<h4 id="rbf">RBF隐式曲面</h4>
<p>使用径向基函数插值：
$$f(\mathbf{x}) = \sum_{i=1}^n \lambda_i \phi(|\mathbf{x} - \mathbf{x}_i|) + p(\mathbf{x})$$
常用核函数：</p>
<ul>
<li>薄板样条：$\phi(r) = r^2 \log r$</li>
<li>多重二次：$\phi(r) = \sqrt{1 + (r/c)^2}$</li>
<li>高斯：$\phi(r) = e^{-(r/c)^2}$</li>
</ul>
<h3 id="533">5.3.3 自相交检测</h3>
<h4 id="_25">空间哈希加速</h4>
<p>将三角形映射到空间网格：
$$h(T) = \{\text{hash}(i, j, k) : (i, j, k) \in \text{bbox}(T)\}$$
期望复杂度从 $O(n^2)$ 降至 $O(n)$。</p>
<p><strong>空间哈希函数</strong>：</p>
<p>对于网格单元 $(i, j, k)$：
$$h(i, j, k) = (i \cdot p_1 \oplus j \cdot p_2 \oplus k \cdot p_3) \mod m$$
其中 $p_1, p_2, p_3$ 是大质数，$\oplus$ 是异或操作，$m$ 是哈希表大小。</p>
<p><strong>网格单元大小选择</strong>：</p>
<p>根据平均三角形大小选择：
$$\text{cell_size} = k \cdot \sqrt[3]{\frac{\text{volume}(\text{bbox})}{n}}$$
其中 $k \approx 2\text{-}3$ 是调节参数。</p>
<p><strong>层次包围盒（BVH）</strong>：</p>
<p>递归构建BVH树：</p>
<div class="codehilite"><pre><span></span><code><span class="k">proc</span><span class="nv">edure</span><span class="w"> </span><span class="nv">BuildBVH</span><span class="p">(</span><span class="nv">triangles</span><span class="p">)</span>
<span class="w">  </span><span class="nf">if</span><span class="w"> </span><span class="o">|</span><span class="nv">triangles</span><span class="o">|</span><span class="w"> </span><span class="err">≤</span><span class="w"> </span><span class="nv">threshold</span><span class="p">:</span>
<span class="w">    </span><span class="nf">return</span><span class="w"> </span><span class="nv">LeafNode</span><span class="p">(</span><span class="nv">triangles</span><span class="p">)</span>

<span class="w">  </span><span class="nf">axis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">选择最长轴</span>
<span class="w">  </span><span class="nf">pivot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">中位数或</span><span class="nv">SAH启发式</span>
<span class="w">  </span><span class="nf">left</span><span class="p">,</span><span class="w"> </span><span class="nv">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">划分三角形</span>

<span class="w">  </span><span class="nf">return</span><span class="w"> </span><span class="nv">InternalNode</span><span class="p">(</span>
<span class="w">    </span><span class="nf">BuildBVH</span><span class="p">(</span><span class="nv">left</span><span class="p">),</span>
<span class="w">    </span><span class="nf">BuildBVH</span><span class="p">(</span><span class="nv">right</span><span class="p">),</span>
<span class="w">    </span><span class="err">合并包围盒</span>
<span class="w">  </span><span class="err">)</span>
</code></pre></div>

<h4 id="_26">精确相交测试</h4>
<p>Möller-Trumbore算法检测三角形相交：
$$\begin{pmatrix} t \\ u \\ v \end{pmatrix} = \frac{1}{\mathbf{e}_1 \cdot (\mathbf{d} \times \mathbf{e}_2)} \begin{pmatrix} \mathbf{q} \cdot \mathbf{e}_2 \\ \mathbf{p} \cdot \mathbf{q} \\ \mathbf{d} \cdot \mathbf{p} \end{pmatrix}$$
其中：</p>
<ul>
<li>$\mathbf{e}_1 = \mathbf{v}_1 - \mathbf{v}_0$，$\mathbf{e}_2 = \mathbf{v}_2 - \mathbf{v}_0$</li>
<li>$\mathbf{p} = \mathbf{d} \times \mathbf{e}_2$，$\mathbf{q} = \mathbf{s} \times \mathbf{e}_1$</li>
</ul>
<p>相交条件：$t &gt; 0$，$u \geq 0$，$v \geq 0$，$u + v \leq 1$。</p>
<p><strong>三角形-三角形相交</strong>：</p>
<p>使用分离轴定理（SAT）：</p>
<p>测试15个潜在分离轴：</p>
<ul>
<li>3个三角形A的法向</li>
<li>3个三角形B的法向</li>
<li>9个边-边叉积方向</li>
</ul>
<p>对每个轴 $\mathbf{a}$，检查投影区间是否重叠：
$$[\min_i(\mathbf{a} \cdot \mathbf{v}_i^A), \max_i(\mathbf{a} \cdot \mathbf{v}_i^A)] \cap [\min_j(\mathbf{a} \cdot \mathbf{v}_j^B), \max_j(\mathbf{a} \cdot \mathbf{v}_j^B)] \neq \emptyset$$
<strong>鲁棒性处理</strong>：</p>
<p>使用精确谓词（Exact Predicates）：</p>
<div class="codehilite"><pre><span></span><code><span class="k">function</span><span class="w"> </span><span class="nf">Orient3D</span><span class="p">(</span>a, b, c, d<span class="p">)</span>
<span class="w">  </span><span class="o">//</span><span class="w"> </span>计算行列式的符号
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nb">sign</span><span class="p">(</span><span class="nb">det</span><span class="p">[</span>
<span class="w">    </span><span class="p">[</span><span class="n">ax</span><span class="o">-</span><span class="n">dx</span><span class="p">,</span><span class="w"> </span><span class="n">ay</span><span class="o">-</span><span class="n">dy</span><span class="p">,</span><span class="w"> </span><span class="n">az</span><span class="o">-</span><span class="n">dz</span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span><span class="n">bx</span><span class="o">-</span><span class="n">dx</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="o">-</span><span class="n">dy</span><span class="p">,</span><span class="w"> </span><span class="n">bz</span><span class="o">-</span><span class="n">dz</span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span><span class="n">cx</span><span class="o">-</span><span class="n">dx</span><span class="p">,</span><span class="w"> </span><span class="n">cy</span><span class="o">-</span><span class="n">dy</span><span class="p">,</span><span class="w"> </span><span class="n">cz</span><span class="o">-</span><span class="n">dz</span><span class="p">]</span>
<span class="w">  </span><span class="p">])</span>
</code></pre></div>

<p>使用自适应精度算术或区间算术保证正确性。</p>
<h4 id="ccd">连续碰撞检测（CCD）</h4>
<p>对于运动三角形，求解：
$$\min t \in [0, 1] : T_1(t) \cap T_2(t) \neq \emptyset$$
使用三次多项式根求解。</p>
<h3 id="534">5.3.4 自相交消除</h3>
<h4 id="_27">布尔运算方法</h4>
<p>通过自并集消除自相交：
$$M_{\text{clean}} = M \cup M$$
使用BSP树或Exact Predicates确保鲁棒性。</p>
<h4 id="mesh-surgery">网格手术（Mesh Surgery）</h4>
<p>局部移除和重新三角化：</p>
<ol>
<li>识别相交区域</li>
<li>删除涉及三角形</li>
<li>重新三角化空洞</li>
<li>光滑过渡区域</li>
</ol>
<h4 id="_28">收缩膨胀法</h4>
<p>通过Mean Curvature Flow收缩：
$$\frac{\partial \mathbf{x}}{\partial t} = -H\mathbf{n}$$
然后反向膨胀恢复体积。</p>
<h3 id="535">5.3.5 水密性保证</h3>
<h4 id="_29">定向一致性</h4>
<p>使用传播算法统一法向：
$$\mathbf{n}_j = \begin{cases}
\mathbf{n}_j &amp; \text{if } \mathbf{n}_i \cdot \mathbf{n}_j &gt; 0 \\
-\mathbf{n}_j &amp; \text{otherwise}
\end{cases}$$
<strong>全局定向算法</strong>：</p>
<ol>
<li><strong>构建邻接图</strong>：三角形作为节点，共享边的三角形相连</li>
<li><strong>宽度优先搜索</strong>：</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="nv">queue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[选择一个种子三角形]
<span class="nv">visited</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">set</span><span class="ss">()</span>

<span class="k">while</span><span class="w"> </span><span class="nv">queue</span>:
<span class="w">  </span><span class="nv">tri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">queue</span>.<span class="nv">pop</span><span class="ss">()</span>
<span class="w">  </span><span class="nv">visited</span>.<span class="nv">add</span><span class="ss">(</span><span class="nv">tri</span><span class="ss">)</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="nv">neighbor</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">tri</span>.<span class="nv">neighbors</span>:
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nv">neighbor</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">visited</span>:
<span class="w">      </span>调整<span class="nv">neighbor</span>使其与<span class="nv">tri</span>一致
<span class="w">      </span><span class="nv">queue</span>.<span class="nv">append</span><span class="ss">(</span><span class="nv">neighbor</span><span class="ss">)</span>
</code></pre></div>

<ol start="3">
<li><strong>处理多个连通分量</strong>：对每个分量独立定向</li>
</ol>
<p><strong>法向一致性检查</strong>：</p>
<p>对于共享边 $(v_i, v_j)$ 的两个三角形，检查边的方向：</p>
<ul>
<li>一致定向：一个三角形中是 $(v_i, v_j)$，另一个中是 $(v_j, v_i)$</li>
<li>不一致：两个三角形中都是同一方向</li>
</ul>
<h4 id="_30">射线法内外判定</h4>
<p>点 $\mathbf{p}$ 在网格内部当且仅当：
$$\text{winding number}(\mathbf{p}) = \frac{1}{4\pi} \sum_{T \in M} \Omega_T(\mathbf{p}) \neq 0$$
其中 $\Omega_T(\mathbf{p})$ 是三角形 $T$ 对点 $\mathbf{p}$ 的立体角。</p>
<h2 id="54-loopcatmull-clark">5.4 细分曲面：Loop、Catmull-Clark</h2>
<p>细分算法通过递归细化产生光滑曲面，在3D打印中用于提高模型质量。</p>
<h3 id="541-loop">5.4.1 Loop细分（三角网格）</h3>
<h4 id="_31">顶点更新规则</h4>
<p>对于内部顶点（度为 $n$）：
$$\mathbf{v}' = (1 - n\beta)\mathbf{v} + \beta \sum_{i=1}^n \mathbf{v}_i$$
其中 $\beta$ 的选择：
$$\beta = \begin{cases}
\frac{3}{8n} &amp; \text{Warren's choice} \\
\frac{1}{n}\left(\frac{5}{8} - \left(\frac{3}{8} + \frac{1}{4}\cos\frac{2\pi}{n}\right)^2\right) &amp; \text{Loop's choice}
\end{cases}$$</p>
<h4 id="_32">边点插入</h4>
<p>新边点位置：
$$\mathbf{e} = \frac{3}{8}(\mathbf{v}_1 + \mathbf{v}_2) + \frac{1}{8}(\mathbf{v}_3 + \mathbf{v}_4)$$
其中 $\mathbf{v}_1, \mathbf{v}_2$ 是边的端点，$\mathbf{v}_3, \mathbf{v}_4$ 是对顶点。</p>
<h4 id="_33">极限位置</h4>
<p>顶点的极限位置：
$$\mathbf{v}_{\infty} = \frac{1}{1 + \frac{3n}{8}}\left(\mathbf{v} + \frac{3}{8}\sum_{i=1}^n \mathbf{v}_i\right)$$</p>
<h4 id="_34">特征值分析</h4>
<p>细分矩阵 $\mathbf{S}$ 的特征值：</p>
<ul>
<li>$\lambda_0 = 1$（保持仿射不变性）</li>
<li>$\lambda_1 = \lambda_2 = \frac{3 + 2\cos(2\pi/n)}{8}$（切平面）</li>
<li>$|\lambda_i| &lt; 1$ for $i &gt; 2$（收敛性）</li>
</ul>
<h3 id="542-catmull-clark">5.4.2 Catmull-Clark细分（四边形网格）</h3>
<h4 id="_35">面点规则</h4>
<p>$$\mathbf{f} = \frac{1}{n}\sum_{i=1}^n \mathbf{v}_i$$</p>
<h4 id="_36">边点规则</h4>
<p>$$\mathbf{e} = \frac{1}{4}(\mathbf{v}_1 + \mathbf{v}_2 + \mathbf{f}_1 + \mathbf{f}_2)$$</p>
<h4 id="_37">顶点更新</h4>
<p>对于度为 $n$ 的顶点：
$$\mathbf{v}' = \frac{n-2}{n}\mathbf{v} + \frac{1}{n^2}\sum_{i=1}^n \mathbf{e}_i + \frac{1}{n^2}\sum_{i=1}^n \mathbf{f}_i$$</p>
<h4 id="_38">奇异点处理</h4>
<p>非四边形面产生的奇异点，使用特殊规则：
$$\mathbf{v}' = \frac{1}{n}\left(\mathbf{v} + \frac{2}{n}\sum_{i=1}^n \mathbf{e}_i + \frac{1}{n}\sum_{i=1}^n \mathbf{f}_i\right)$$</p>
<h3 id="543-sqrt3-">5.4.3 $\sqrt{3}$-细分</h3>
<h4 id="_39">拓扑规则</h4>
<p>每个三角形分成三个，顶点度趋向6：
$$|F'| = 3|F|, \quad |V'| = |V| + |F|$$</p>
<h4 id="_40">几何规则</h4>
<p>新面点：
$$\mathbf{f} = \frac{1}{3}(\mathbf{v}_1 + \mathbf{v}_2 + \mathbf{v}_3)$$
顶点更新：
$$\mathbf{v}' = (1 - \alpha_n)\mathbf{v} + \alpha_n \bar{\mathbf{v}}$$
其中：
$$\alpha_n = \frac{4 - 2\cos(2\pi/n)}{9}$$</p>
<h3 id="544">5.4.4 自适应细分</h3>
<h4 id="_41">误差驱动细分</h4>
<p>基于曲率的细分准则：
$$\text{subdivide}(T) = \begin{cases}
\text{true} &amp; \text{if } \kappa_{\max} \cdot h &gt; \tau \\
\text{false} &amp; \text{otherwise}
\end{cases}$$</p>
<h4 id="t-">T-顶点处理</h4>
<p>避免裂缝的红绿细分：</p>
<ul>
<li>红色分裂：1→4</li>
<li>绿色分裂：1→2（过渡）</li>
</ul>
<p>保持一级邻域细分差异 ≤ 1。</p>
<h3 id="545">5.4.5 细分曲面的解析性质</h3>
<h4 id="c2">$C^2$连续性</h4>
<p>除奇异点外处处 $C^2$ 连续。奇异点处：</p>
<ul>
<li>Loop：$C^1$ 连续（$n \neq 6$）</li>
<li>Catmull-Clark：$C^1$ 连续（$n \neq 4$）</li>
</ul>
<h4 id="_42">极限曲面评估</h4>
<p>使用Stam的方法直接计算极限曲面：
$$\mathbf{S}(u, v) = \mathbf{b}(u, v)^T \mathbf{A}^n \mathbf{P}$$
其中 $\mathbf{A}$ 是细分矩阵，$\mathbf{b}$ 是基函数。</p>
<h2 id="55-arap">5.5 网格变形：ARAP、笼形变形</h2>
<p>网格变形在3D打印中用于设计修改、形状优化和适应性调整。</p>
<h3 id="551-as-rigid-as-possible-arap">5.5.1 As-Rigid-As-Possible (ARAP)</h3>
<h4 id="_43">能量函数</h4>
<p>ARAP最小化局部非刚性变形：
$$E(\mathbf{p}') = \sum_{i \in V} w_i \sum_{j \in N(i)} w_{ij} |\mathbf{p}'_i - \mathbf{p}'_j - \mathbf{R}_i(\mathbf{p}_i - \mathbf{p}_j)|^2$$
其中 $\mathbf{R}_i$ 是顶点 $i$ 的局部旋转矩阵。</p>
<h4 id="_44">交替优化</h4>
<h5 id="1">步骤1：固定位置求旋转</h5>
<p>使用SVD求解Procrustes问题：
$$\mathbf{S}_i = \sum_{j \in N(i)} w_{ij}(\mathbf{p}_i - \mathbf{p}_j)(\mathbf{p}'_i - \mathbf{p}'_j)^T$$
分解 $\mathbf{S}_i = \mathbf{U}_i \boldsymbol{\Sigma}_i \mathbf{V}_i^T$，则：
$$\mathbf{R}_i = \mathbf{V}_i \mathbf{U}_i^T$$
处理反射：若 $\det(\mathbf{R}_i) &lt; 0$，翻转最小奇异值对应的列。</p>
<h5 id="2">步骤2：固定旋转求位置</h5>
<p>求解线性系统：
$$\mathbf{L}\mathbf{p}' = \mathbf{b}$$
其中Laplacian矩阵：
$$L_{ij} = \begin{cases}
\sum_{k \in N(i)} w_{ik} &amp; i = j \\
-w_{ij} &amp; j \in N(i) \\
0 &amp; \text{otherwise}
\end{cases}$$
右端项：
$$\mathbf{b}_i = \sum_{j \in N(i)} \frac{w_{ij}}{2}(\mathbf{R}_i + \mathbf{R}_j)(\mathbf{p}_i - \mathbf{p}_j)$$</p>
<h4 id="_45">权重选择</h4>
<p>余切权重（保持共形性）：
$$w_{ij} = \frac{1}{2}(\cot \alpha_{ij} + \cot \beta_{ij})$$
均匀权重（简单快速）：
$$w_{ij} = 1$$</p>
<h3 id="552-cage-based-deformation">5.5.2 笼形变形（Cage-based Deformation）</h3>
<h4 id="mean-value-coordinates-mvc">Mean Value Coordinates (MVC)</h4>
<p>对于点 $\mathbf{p}$ 在笼子内的坐标：
$$\lambda_i(\mathbf{p}) = \frac{w_i}{\sum_j w_j}$$
其中：
$$w_i = \frac{\tan(\alpha_{i-1}/2) + \tan(\alpha_i/2)}{|\mathbf{v}_i - \mathbf{p}|}$$
$\alpha_i$ 是从 $\mathbf{p}$ 看顶点 $i$ 和 $i+1$ 的夹角。</p>
<h4 id="harmonic-coordinates">Harmonic Coordinates</h4>
<p>通过求解Laplace方程获得：
$$\Delta \phi_i = 0 \text{ in } \Omega$$
$$\phi_i = \delta_{ij} \text{ on } \partial\Omega$$
离散化为线性系统：
$$\mathbf{L}_{\text{int}} \boldsymbol{\phi}_{\text{int}} + \mathbf{L}_{\text{bnd}} \boldsymbol{\phi}_{\text{bnd}} = \mathbf{0}$$</p>
<h4 id="green-coordinates">Green Coordinates</h4>
<p>包含法向分量的坐标：
$$\mathbf{p} = \sum_{i} \phi_i(\mathbf{p})\mathbf{v}_i + \sum_{j} \psi_j(\mathbf{p})\mathbf{n}_j$$
其中 $\psi_j$ 是面的贡献：
$$\psi_j = -\frac{1}{4\pi} \int_{T_j} \frac{\mathbf{n}_j \cdot (\mathbf{x} - \mathbf{p})}{|\mathbf{x} - \mathbf{p}|^3} dA$$</p>
<h3 id="553">5.5.3 基于物理的变形</h3>
<h4 id="_46">线弹性模型</h4>
<p>应变能密度：
$$W = \frac{\lambda}{2}(\text{tr}(\boldsymbol{\varepsilon}))^2 + \mu \text{tr}(\boldsymbol{\varepsilon}^2)$$
其中应变张量：
$$\boldsymbol{\varepsilon} = \frac{1}{2}(\nabla \mathbf{u} + \nabla \mathbf{u}^T)$$</p>
<h4 id="_47">共旋线性模型</h4>
<p>分解变形梯度：
$$\mathbf{F} = \mathbf{R}\mathbf{S}$$
应力计算：
$$\boldsymbol{\sigma} = \mathbf{R}(2\mu \boldsymbol{\varepsilon} + \lambda \text{tr}(\boldsymbol{\varepsilon})\mathbf{I})$$</p>
<h4 id="neo-hookean">Neo-Hookean模型</h4>
<p>超弹性能量：
$$W = \frac{\mu}{2}(I_C - 3) - \mu \log J + \frac{\lambda}{2}(\log J)^2$$
其中 $I_C = \text{tr}(\mathbf{F}^T\mathbf{F})$，$J = \det(\mathbf{F})$。</p>
<h3 id="554-ffd">5.5.4 自由形式变形（FFD）</h3>
<h4 id="b">B样条体</h4>
<p>变形函数：
$$\mathbf{p}'(\mathbf{u}) = \sum_{i,j,k} B_i(u)B_j(v)B_k(w) \mathbf{P}_{ijk}$$
其中 $B_i$ 是B样条基函数，$\mathbf{P}_{ijk}$ 是控制点。</p>
<h4 id="nurbs">NURBS变形</h4>
<p>加权版本：
$$\mathbf{p}'(\mathbf{u}) = \frac{\sum_{i,j,k} w_{ijk}B_i(u)B_j(v)B_k(w) \mathbf{P}_{ijk}}{\sum_{i,j,k} w_{ijk}B_i(u)B_j(v)B_k(w)}$$</p>
<h4 id="t">T样条变形</h4>
<p>支持局部细化的变形：
$$\mathbf{p}'(\mathbf{u}) = \sum_{\alpha \in \mathcal{A}} N_{\alpha}(\mathbf{u}) \mathbf{P}_{\alpha}$$
其中 $N_{\alpha}$ 是T样条基函数。</p>
<h3 id="555">5.5.5 约束变形</h3>
<h4 id="_48">位置约束</h4>
<p>硬约束（拉格朗日乘子）：
$$\min_{\mathbf{x}} E(\mathbf{x}) \text{ s.t. } \mathbf{C}\mathbf{x} = \mathbf{d}$$
KKT系统：
$$\begin{pmatrix} \mathbf{H} &amp; \mathbf{C}^T \\ \mathbf{C} &amp; \mathbf{0} \end{pmatrix} \begin{pmatrix} \mathbf{x} \\ \boldsymbol{\lambda} \end{pmatrix} = \begin{pmatrix} -\mathbf{g} \\ \mathbf{d} \end{pmatrix}$$
软约束（罚函数）：
$$E_{\text{total}} = E_{\text{deform}} + \alpha |\mathbf{C}\mathbf{x} - \mathbf{d}|^2$$</p>
<h4 id="_49">体积保持</h4>
<p>局部体积约束：
$$V_T = \frac{1}{6}|(\mathbf{p}_1 - \mathbf{p}_0) \cdot ((\mathbf{p}_2 - \mathbf{p}_0) \times (\mathbf{p}_3 - \mathbf{p}_0))|$$
全局体积：
$$V = \sum_{T \in \mathcal{T}} V_T = V_0$$</p>
<h4 id="_50">长度保持</h4>
<p>边长约束：
$$|\mathbf{p}'_i - \mathbf{p}'_j| = l_{ij}$$
使用投影动力学求解：
$$\mathbf{p}^{(k+1)} = \arg\min_{\mathbf{p}} |\mathbf{p} - \mathbf{q}^{(k)}|_{\mathbf{M}}^2$$
其中 $\mathbf{q}^{(k)}$ 是投影到约束流形的位置。</p>
<h2 id="_51">本章小结</h2>
<p>本章系统介绍了网格处理的核心算法，从简化、重新网格化到修复、细分和变形。关键要点：</p>
<ol>
<li>
<p><strong>网格简化</strong>：QEM提供了高效的误差度量，通过二次形式优雅地累积和最小化几何误差。渐进网格支持多分辨率表示和视相关渲染。</p>
</li>
<li>
<p><strong>重新网格化</strong>：各向同性方法追求均匀三角形，各向异性方法根据曲率自适应调整尺寸和方向。CVT和各向异性Delaunay提供了理论保证。</p>
</li>
<li>
<p><strong>网格修复</strong>：孔洞填充需要平衡几何质量和计算效率。自相交检测和消除是确保3D打印可制造性的关键步骤。</p>
</li>
<li>
<p><strong>细分曲面</strong>：Loop和Catmull-Clark提供了 $C^2$ 连续的极限曲面（除奇异点外）。$\sqrt{3}$-细分提供了更好的顶点度分布。</p>
</li>
<li>
<p><strong>网格变形</strong>：ARAP通过交替优化实现保形变形。笼形变形提供了直观的控制方式。物理模拟提供了真实的变形效果。</p>
</li>
</ol>
<h3 id="_52">核心数学工具</h3>
<ul>
<li><strong>二次形式</strong>：$\mathbf{x}^T\mathbf{Q}\mathbf{x}$ 用于误差度量和能量优化</li>
<li><strong>SVD分解</strong>：求解最优旋转和Procrustes问题</li>
<li><strong>Laplace算子</strong>：离散微分几何的基础工具</li>
<li><strong>有限元方法</strong>：物理变形的数值求解</li>
<li><strong>优化理论</strong>：交替方向法、投影动力学</li>
</ul>
<h3 id="_53">算法复杂度总结</h3>
<p>| 算法 | 时间复杂度 | 空间复杂度 | 备注 |</p>
<table>
<thead>
<tr>
<th>算法</th>
<th>时间复杂度</th>
<th>空间复杂度</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>QEM简化</td>
<td>$O(n \log n)$</td>
<td>$O(n)$</td>
<td>使用优先队列</td>
</tr>
<tr>
<td>Lloyd迭代</td>
<td>$O(kn)$</td>
<td>$O(n)$</td>
<td>k次迭代</td>
</tr>
<tr>
<td>孔洞填充(DP)</td>
<td>$O(n^3)$</td>
<td>$O(n^2)$</td>
<td>n为边界顶点数</td>
</tr>
<tr>
<td>Loop细分</td>
<td>$O(n)$</td>
<td>$O(n)$</td>
<td>线性增长</td>
</tr>
<tr>
<td>ARAP变形</td>
<td>$O(n + m)$</td>
<td>$O(n^2)$</td>
<td>稀疏矩阵</td>
</tr>
</tbody>
</table>
<h2 id="_54">练习题</h2>
<h3 id="_55">基础题</h3>
<p><strong>习题5.1</strong> 证明QEM中的误差矩阵 $\mathbf{Q}$ 是半正定的。</p>
<details>
<summary>提示</summary>
<p>考虑 $\mathbf{Q} = \sum_p \mathbf{n}_p \mathbf{n}_p^T$ 的形式，利用外积矩阵的性质。</p>
</details>
<details>
<summary>答案</summary>
<p>对任意向量 $\mathbf{v} \neq \mathbf{0}$：
$$\mathbf{v}^T\mathbf{Q}\mathbf{v} = \mathbf{v}^T\left(\sum_p \mathbf{n}_p \mathbf{n}_p^T\right)\mathbf{v} = \sum_p (\mathbf{n}_p^T\mathbf{v})^2 \geq 0$$
等号成立当且仅当 $\mathbf{v}$ 垂直于所有平面法向量。因此 $\mathbf{Q}$ 半正定。</p>
</details>
<p><strong>习题5.2</strong> 推导Loop细分中边点权重 $3/8$ 和 $1/8$ 的来源。</p>
<details>
<summary>提示</summary>
<p>考虑立方B样条的细分规则和张量积。</p>
</details>
<details>
<summary>答案</summary>
<p>Loop细分基于三向Box样条。对于均匀B样条，细分规则为：</p>
<ul>
<li>边点：$(1/2, 1/2)$ 在一维</li>
<li>三角形的张量积给出：$(3/8, 3/8, 1/8, 1/8)$
这保证了 $C^2$ 连续性和仿射不变性。</li>
</ul>
</details>
<p><strong>习题5.3</strong> 计算正四面体网格经过一次Catmull-Clark细分后的顶点数、边数和面数。</p>
<details>
<summary>提示</summary>
<p>使用欧拉公式 $V - E + F = 2$ 验证结果。</p>
</details>
<details>
<summary>答案</summary>
<p>原始：$V = 4$，$E = 6$，$F = 4$
细分后：</p>
<ul>
<li>面点：4个</li>
<li>边点：6个  </li>
<li>原顶点：4个</li>
<li>总顶点：$V' = 4 + 6 + 4 = 14$</li>
<li>每个三角面产生3个四边形：$F' = 4 \times 3 = 12$</li>
<li>由欧拉公式：$E' = V' + F' - 2 = 14 + 12 - 2 = 24$</li>
</ul>
</details>
<p><strong>习题5.4</strong> 给定2D多边形边界，使用最小面积三角化的动态规划算法，计算凸四边形ABCD的最优三角化。</p>
<details>
<summary>提示</summary>
<p>枚举中间顶点，递归计算子问题。</p>
</details>
<details>
<summary>答案</summary>
<p>设顶点按逆时针排列。两种可能：</p>
<ol>
<li>对角线AC：面积 = $|△ABC| + |△ACD|$</li>
<li>对角线BD：面积 = $|△ABD| + |△BCD|$</li>
</ol>
<p>选择面积较小的方案。面积计算：
$$|△| = \frac{1}{2}|x_1(y_2-y_3) + x_2(y_3-y_1) + x_3(y_1-y_2)|$$</p>
</details>
<h3 id="_56">挑战题</h3>
<p><strong>习题5.5</strong> 设计一个保体积的网格简化算法。给出能量函数和优化策略。</p>
<details>
<summary>提示</summary>
<p>在QEM基础上添加体积约束项，使用拉格朗日乘子法。</p>
</details>
<details>
<summary>答案</summary>
<p>增强的能量函数：
$$E(\mathbf{v}) = E_{QEM}(\mathbf{v}) + \lambda |V(\mathbf{v}) - V_0|$$
其中体积变化：
$$\Delta V = \frac{1}{6} \sum_{T \in \text{affected}} \text{sign}(T) \cdot \mathbf{v} \cdot (\mathbf{v}_i \times \mathbf{v}_j)$$
使用二阶近似：
$$V(\mathbf{v}) \approx V_0 + \nabla V^T(\mathbf{v} - \mathbf{v}_0) + \frac{1}{2}(\mathbf{v} - \mathbf{v}_0)^T\mathbf{H}_V(\mathbf{v} - \mathbf{v}_0)$$
通过迭代调整 $\lambda$ 保持体积。</p>
</details>
<p><strong>习题5.6</strong> 分析ARAP变形的收敛性。在什么条件下算法可能不收敛？</p>
<details>
<summary>提示</summary>
<p>考虑能量函数的下界和每步迭代的单调性。</p>
</details>
<details>
<summary>答案</summary>
<p>ARAP能量函数有下界0（完全刚性变形）。每步迭代：</p>
<ol>
<li>固定 $\mathbf{p}'$ 求 $\mathbf{R}$：闭式解最优</li>
<li>固定 $\mathbf{R}$ 求 $\mathbf{p}'$：凸二次问题，全局最优</li>
</ol>
<p>因此能量单调递减，算法收敛到局部最小值。</p>
<p>不收敛情况：</p>
<ul>
<li>约束不相容（如冲突的位置约束）</li>
<li>数值问题（矩阵病态、浮点误差累积）</li>
<li>退化配置（所有点共线）</li>
</ul>
<p>改进：添加正则项 $\epsilon|\mathbf{p}' - \mathbf{p}|^2$</p>
</details>
<p><strong>习题5.7</strong> 推导各向异性Voronoi图的对偶是各向异性Delaunay三角化。定义合适的度量空间。</p>
<details>
<summary>提示</summary>
<p>在Riemannian度量下重新定义距离和外接椭圆。</p>
</details>
<details>
<summary>答案</summary>
<p>定义度量张量场 $\mathbf{M}(\mathbf{x})$，距离：
$$d_{\mathbf{M}}(\mathbf{x}, \mathbf{y}) = \int_0^1 \sqrt{\dot{\gamma}(t)^T \mathbf{M}(\gamma(t)) \dot{\gamma}(t)} dt$$
其中 $\gamma$ 是连接 $\mathbf{x}$ 和 $\mathbf{y}$ 的测地线。</p>
<p>Voronoi区域：
$$V_i = \{\mathbf{x} : d_{\mathbf{M}}(\mathbf{x}, \mathbf{p}_i) \leq d_{\mathbf{M}}(\mathbf{x}, \mathbf{p}_j), \forall j\}$$
对偶的Delaunay条件：三点 $(p_i, p_j, p_k)$ 形成三角形当且仅当存在点 $\mathbf{c}$ 使得：
$$d_{\mathbf{M}}(\mathbf{c}, \mathbf{p}_i) = d_{\mathbf{M}}(\mathbf{c}, \mathbf{p}_j) = d_{\mathbf{M}}(\mathbf{c}, \mathbf{p}_k) \leq d_{\mathbf{M}}(\mathbf{c}, \mathbf{p}_l), \forall l$$</p>
<p>这定义了各向异性空圆性质。</p>
</details>
<p><strong>习题5.8</strong> 设计一个检测和修复非流形顶点的算法。考虑顶点的邻域不同胚于圆盘的情况。</p>
<details>
<summary>提示</summary>
<p>分析顶点1-环的连通分量，考虑"蝴蝶结"和"沙漏"配置。</p>
</details>
<details>
<summary>答案</summary>
<p>算法步骤：</p>
<ol>
<li><strong>检测非流形顶点</strong>：</li>
</ol>
<div class="codehilite"><pre><span></span><code>对每个顶点<span class="nv">v</span>：
<span class="w">  </span>构建<span class="mi">1</span><span class="o">-</span>环面集合<span class="nv">F</span><span class="ss">(</span><span class="nv">v</span><span class="ss">)</span>
<span class="w">  </span>构建边<span class="o">-</span>面关联图<span class="nv">G</span>
<span class="w">  </span>计算<span class="nv">G</span>的连通分量数<span class="nv">k</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="nv">k</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span>:<span class="w"> </span><span class="nv">v</span>是非流形顶点
</code></pre></div>

<ol start="2">
<li>
<p><strong>分类非流形类型</strong>：
   - 蝴蝶结：两个或多个圆盘在顶点相接
   - 非流形边：边被超过2个面共享</p>
</li>
<li>
<p><strong>修复策略</strong>：
   - <strong>顶点分裂</strong>：</p>
</li>
</ol>
<div class="codehilite"><pre><span></span><code>创建k个新顶点v₁...vₖ
将第i个连通分量的面关联到vᵢ
更新拓扑连接
</code></pre></div>

<ul>
<li><strong>局部重网格化</strong>：</li>
</ul>
<div class="codehilite"><pre><span></span><code>删除非流形配置的面
使用推进波前法重新三角化
确保流形性约束
</code></pre></div>

<ol start="4">
<li><strong>验证</strong>：
   检查Link条件：$\text{link}(v)$ 应同胚于圆或线段</li>
</ol>
<p>时间复杂度：$O(n \cdot d_{max})$，其中 $d_{max}$ 是最大顶点度。</p>
</details>
<h2 id="_57">常见陷阱与错误</h2>
<h3 id="1-qem">1. QEM简化的数值不稳定</h3>
<p><strong>问题</strong>：当多个平面近似共面时，矩阵 $\mathbf{Q}$ 接近奇异。</p>
<p><strong>症状</strong>：</p>
<ul>
<li>顶点位置计算出现NaN或极大值</li>
<li>简化后网格出现尖刺</li>
</ul>
<p><strong>解决方案</strong>：</p>
<ul>
<li>使用SVD代替直接求逆</li>
<li>添加正则项：$\mathbf{Q}_{reg} = \mathbf{Q} + \epsilon \mathbf{I}$</li>
<li>回退到端点或中点</li>
</ul>
<h3 id="2_1">2. 自相交检测的浮点误差</h3>
<p><strong>问题</strong>：浮点运算导致的几何谓词不一致。</p>
<p><strong>症状</strong>：</p>
<ul>
<li>明显相交的三角形未被检测</li>
<li>错误的拓扑判断</li>
</ul>
<p><strong>解决方案</strong>：</p>
<ul>
<li>使用精确谓词（Shewchuk's predicates）</li>
<li>实现符号扰动（Simulation of Simplicity）</li>
<li>使用区间算术</li>
</ul>
<h3 id="3">3. 细分曲面的奇异点处理</h3>
<p><strong>问题</strong>：非正则顶点（度≠6 for Loop，度≠4 for Catmull-Clark）导致的曲率问题。</p>
<p><strong>症状</strong>：</p>
<ul>
<li>奇异点处出现褶皱或平坦区域</li>
<li>曲率不连续</li>
</ul>
<p><strong>解决方案</strong>：</p>
<ul>
<li>使用特殊的奇异点规则</li>
<li>局部重参数化</li>
<li>自适应细分避免过度细化</li>
</ul>
<h3 id="4-arap">4. ARAP变形的局部最小值</h3>
<p><strong>问题</strong>：交替优化陷入次优解。</p>
<p><strong>症状</strong>：</p>
<ul>
<li>大变形时出现不自然的扭曲</li>
<li>不同初始化导致不同结果</li>
</ul>
<p><strong>解决方案</strong>：</p>
<ul>
<li>使用多分辨率策略</li>
<li>添加动量项</li>
<li>结合全局优化方法</li>
</ul>
<h3 id="5_1">5. 孔洞填充的拓扑歧义</h3>
<p><strong>问题</strong>：复杂孔洞可能有多种拓扑上不同的填充方式。</p>
<p><strong>症状</strong>：</p>
<ul>
<li>填充结果与预期拓扑不符</li>
<li>产生自相交</li>
</ul>
<p><strong>解决方案</strong>：</p>
<ul>
<li>用户指导的拓扑选择</li>
<li>基于上下文的启发式</li>
<li>多个候选方案的评分</li>
</ul>
<h2 id="_58">最佳实践检查清单</h2>
<h3 id="_59">网格简化</h3>
<ul>
<li>[ ] 选择合适的误差度量（QEM、Hausdorff距离、法向偏差）</li>
<li>[ ] 保持边界和特征边</li>
<li>[ ] 验证拓扑不变性（亏格、连通分量）</li>
<li>[ ] 检查三角形质量（避免退化）</li>
<li>[ ] 实现渐进式存储（支持LOD）</li>
</ul>
<h3 id="_60">重新网格化</h3>
<ul>
<li>[ ] 根据应用选择各向同性或各向异性</li>
<li>[ ] 设置合适的目标边长/密度</li>
<li>[ ] 保持特征线和约束</li>
<li>[ ] 优化三角形质量指标</li>
<li>[ ] 处理边界和孔洞</li>
</ul>
<h3 id="_61">网格修复</h3>
<ul>
<li>[ ] 完整的缺陷检测（孔洞、自相交、非流形）</li>
<li>[ ] 选择合适的填充算法（平面、曲率感知）</li>
<li>[ ] 确保水密性和定向一致性</li>
<li>[ ] 验证修复后的拓扑正确性</li>
<li>[ ] 保存修复日志用于追溯</li>
</ul>
<h3 id="_62">细分曲面</h3>
<ul>
<li>[ ] 选择合适的细分方案（Loop for 三角形、Catmull-Clark for 四边形）</li>
<li>[ ] 处理边界和折痕</li>
<li>[ ] 控制细分层数（避免过度细化）</li>
<li>[ ] 实现自适应细分（基于曲率或视角）</li>
<li>[ ] 优化内存使用（增量计算）</li>
</ul>
<h3 id="_63">网格变形</h3>
<ul>
<li>[ ] 选择合适的变形方法（ARAP保形、FFD全局控制）</li>
<li>[ ] 设置合理的约束（位置、体积、长度）</li>
<li>[ ] 实现多分辨率编辑</li>
<li>[ ] 提供实时预览</li>
<li>[ ] 支持撤销/重做操作</li>
</ul>
            </article>
            
            <nav class="page-nav"><a href="./chapter4.html" class="nav-link prev">← 第4章：计算拓扑与同调</a><a href="./chapter6.html" class="nav-link next">第6章：有限元方法与结构分析 →</a></nav>
        </main>
    </div>
</body>
</html>