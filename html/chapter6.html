<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>第6章：有限元方法与结构分析</title>
    <link rel="stylesheet" href="./assets/style.css">
    <link rel="stylesheet" href="./assets/highlight.css">
    <script src="./assets/script.js" defer></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']],
                processEscapes: false,
                packages: {'[+]': ['noerrors', 'ams']}
            },
            options: {
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process'
            },
            loader: {
                load: ['[tex]/noerrors', '[tex]/ams']
            }
        };
    </script>
</head>
<body>
    <div class="container">
        <nav id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <h3>目录</h3>
                <button id="sidebar-toggle" class="sidebar-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
            <ul class="nav-list"><li class=""><a href="./index.html">3D打印中的数学原理与计算方法</a></li><li class=""><a href="./chapter1.html">第1章：几何表示与变换</a></li><li class=""><a href="./chapter2.html">第2章：微分几何与离散算子</a></li><li class=""><a href="./chapter3.html">第3章：计算共形几何</a></li><li class=""><a href="./chapter4.html">第4章：计算拓扑与同调</a></li><li class=""><a href="./chapter5.html">第5章：网格处理算法</a></li><li class="active"><a href="./chapter6.html">第6章：有限元方法与结构分析</a></li><li class=""><a href="./chapter7.html">第7章：拓扑优化基础</a></li><li class=""><a href="./chapter8.html">第8章：高级拓扑优化</a></li><li class=""><a href="./chapter9.html">第9章：切片算法与支撑生成</a></li><li class=""><a href="./chapter10.html">第10章：路径规划与填充</a></li><li class=""><a href="./chapter11.html">第11章：误差分析与补偿</a></li><li class=""><a href="./chapter12.html">第12章：流体仿真基础</a></li><li class=""><a href="./chapter13.html">第13章：多相流与传热</a></li><li class=""><a href="./chapter14.html">第14章：多视图几何</a></li><li class=""><a href="./chapter15.html">第15章：神经隐式表示</a></li><li class=""><a href="./chapter16.html">第16章：3D Gaussian Splatting</a></li><li class=""><a href="./chapter17.html">第17章：可微渲染基础</a></li><li class=""><a href="./chapter18.html">第18章：高级可微渲染与逆向问题</a></li><li class=""><a href="./chapter19.html">第19章：符号几何与程序化建模</a></li><li class=""><a href="./chapter20.html">第20章：神经程序合成</a></li><li class=""><a href="./chapter21.html">第21章：深度生成模型</a></li><li class=""><a href="./chapter22.html">第22章：形状分析与检索</a></li><li class=""><a href="./chapter23.html">第23章：多材料与4D打印</a></li><li class=""><a href="./chapter24.html">第24章：仿生设计与自然算法</a></li><li class=""><a href="./chapter25.html">第25章：逆向问题与参数估计</a></li><li class=""><a href="./chapter26.html">第26章：实时仿真与数字孪生</a></li><li class=""><a href="./chapter27.html">第27章：常用工具与库</a></li><li class=""><a href="./CLAUDE.html">Untitled</a></li></ul>
        </nav>
        
        <main class="content">
            <article>
                <h1 id="6">第6章：有限元方法与结构分析</h1>
<p>有限元方法（FEM）是3D打印结构分析的核心数学工具。本章从变分原理出发，系统介绍Galerkin方法、单元构造、系统组装和特征值分析，重点探讨3D打印特有的多物理场耦合问题。我们将深入推导数学原理，分析数值稳定性，并提供大量练习帮助掌握FEM在增材制造中的应用。</p>
<h2 id="61-galerkin">6.1 Galerkin方法与弱形式</h2>
<h3 id="611">6.1.1 强形式到弱形式的转换</h3>
<p>考虑线弹性力学的平衡方程（强形式）：
$$-\nabla \cdot \boldsymbol{\sigma} = \mathbf{f} \quad \text{in } \Omega$$
其中 $\boldsymbol{\sigma}$ 是应力张量，$\mathbf{f}$ 是体力。本构关系为：
$$\boldsymbol{\sigma} = \mathbb{C} : \boldsymbol{\varepsilon}$$
应变-位移关系：
$$\boldsymbol{\varepsilon} = \frac{1}{2}(\nabla \mathbf{u} + \nabla \mathbf{u}^T)$$
边界条件：</p>
<ul>
<li>Dirichlet边界：$\mathbf{u} = \overline{\mathbf{u}}$ on $\Gamma_D$</li>
<li>Neumann边界：$\boldsymbol{\sigma} \cdot \mathbf{n} = \overline{\mathbf{t}}$ on $\Gamma_N$</li>
</ul>
<h3 id="612">6.1.2 变分原理与虚功原理</h3>
<p>引入试函数空间和测试函数空间：
$$\mathcal{V} = \{\mathbf{v} \in [H^1(\Omega)]^d : \mathbf{v}|_{\Gamma_D} = 0\}$$
$$\mathcal{S} = \{\mathbf{u} \in [H^1(\Omega)]^d : \mathbf{u}|_{\Gamma_D} = \overline{\mathbf{u}}\}$$
弱形式：找到 $\mathbf{u} \in \mathcal{S}$，使得对所有 $\mathbf{v} \in \mathcal{V}$：
$$\int_\Omega \boldsymbol{\varepsilon}(\mathbf{v}) : \mathbb{C} : \boldsymbol{\varepsilon}(\mathbf{u}) \, d\Omega = \int_\Omega \mathbf{v} \cdot \mathbf{f} \, d\Omega + \int_{\Gamma_N} \mathbf{v} \cdot \overline{\mathbf{t}} \, d\Gamma$$
双线性形式和线性泛函：
$$a(\mathbf{u}, \mathbf{v}) = \int_\Omega \boldsymbol{\varepsilon}(\mathbf{v}) : \mathbb{C} : \boldsymbol{\varepsilon}(\mathbf{u}) \, d\Omega$$
$$l(\mathbf{v}) = \int_\Omega \mathbf{v} \cdot \mathbf{f} \, d\Omega + \int_{\Gamma_N} \mathbf{v} \cdot \overline{\mathbf{t}} \, d\Gamma$$</p>
<h3 id="613-galerkin">6.1.3 Galerkin离散化</h3>
<p>有限维逼近空间：
$$\mathcal{V}_h = \text{span}\{\phi_1, \phi_2, ..., \phi_n\} \subset \mathcal{V}$$
位移场的离散表示：
$$\mathbf{u}_h = \sum_{i=1}^n u_i \phi_i$$
离散弱形式：
$$\sum_{j=1}^n a(\phi_j, \phi_i) u_j = l(\phi_i), \quad i = 1, 2, ..., n$$
矩阵形式：
$$\mathbf{K}\mathbf{u} = \mathbf{f}$$
其中刚度矩阵 $K_{ij} = a(\phi_j, \phi_i)$，载荷向量 $f_i = l(\phi_i)$。</p>
<h3 id="614-lax-milgram">6.1.4 Lax-Milgram定理与适定性</h3>
<p>问题适定性的充分条件：</p>
<ol>
<li><strong>连续性</strong>：$|a(\mathbf{u}, \mathbf{v})| \leq M |\mathbf{u}|_V |\mathbf{v}|_V$</li>
<li><strong>强制性</strong>：$a(\mathbf{v}, \mathbf{v}) \geq \alpha |\mathbf{v}|_V^2$</li>
</ol>
<p>对于线弹性问题，Korn不等式保证了强制性：
$$|\boldsymbol{\varepsilon}(\mathbf{v})|_{L^2} \geq C_K |\mathbf{v}|_{H^1}$$
条件数估计：
$$\kappa(\mathbf{K}) \leq \frac{M}{\alpha} \cdot \frac{H^2}{h^2}$$
其中 $H$ 是域尺寸，$h$ 是网格尺寸。</p>
<h3 id="615">6.1.5 误差估计与收敛性</h3>
<p>Céa引理给出最佳逼近性质：
$$|\mathbf{u} - \mathbf{u}_h|_V \leq \frac{M}{\alpha} \inf_{\mathbf{v}_h \in \mathcal{V}_h} |\mathbf{u} - \mathbf{v}_h|_V$$
对于 $p$ 阶多项式基函数，如果精确解 $\mathbf{u} \in H^{p+1}(\Omega)$：
$$|\mathbf{u} - \mathbf{u}_h|_{H^1} \leq C h^p |\mathbf{u}|_{H^{p+1}}$$
$$|\mathbf{u} - \mathbf{u}_h|_{L^2} \leq C h^{p+1} |\mathbf{u}|_{H^{p+1}}$$</p>
<h4 id="aubin-nitsche">Aubin-Nitsche技巧</h4>
<p>对于 $L^2$ 误差的超收敛性，考虑对偶问题：
$$a(\mathbf{v}, \mathbf{z}) = (\mathbf{e}, \mathbf{v})_{L^2} \quad \forall \mathbf{v} \in \mathcal{V}$$
其中 $\mathbf{e} = \mathbf{u} - \mathbf{u}_h$。若对偶解满足正则性估计 $|\mathbf{z}|_{H^2} \leq C|\mathbf{e}|_{L^2}$，则：
$$|\mathbf{e}|_{L^2}^2 = a(\mathbf{e}, \mathbf{z}) = a(\mathbf{e}, \mathbf{z} - \mathbf{z}_h) \leq C|\mathbf{e}|_{H^1}|\mathbf{z} - \mathbf{z}_h|_{H^1}$$</p>
<h4 id="_1">后验误差估计</h4>
<p>残差型估计子：
$$\eta_K^2 = h_K^2 |\mathbf{f} + \nabla \cdot \boldsymbol{\sigma}_h|_{L^2(K)}^2 + \sum_{e \in \partial K} h_e |[\boldsymbol{\sigma}_h \cdot \mathbf{n}]|_{L^2(e)}^2$$
其中 $[\cdot]$ 表示跨单元边界的跳跃。全局估计：
$$|\mathbf{u} - \mathbf{u}_h|_{H^1} \leq C \left(\sum_{K \in \mathcal{T}_h} \eta_K^2\right)^{1/2}$$</p>
<h3 id="616">6.1.6 稳定化方法</h3>
<h4 id="supgpspg">SUPG/PSPG稳定化</h4>
<p>对于对流占优问题，添加稳定项：
$$a_{stab}(\mathbf{u}_h, \mathbf{v}_h) = \sum_K \tau_K \int_K (\mathbf{a} \cdot \nabla \mathbf{v}_h) \cdot \mathcal{R}(\mathbf{u}_h) \, d\Omega$$
其中残差 $\mathcal{R}(\mathbf{u}_h) = \mathbf{f} - \mathcal{L}\mathbf{u}_h$，稳定参数：
$$\tau_K = \frac{h_K}{2|\mathbf{a}|} \left(\coth(Pe_K) - \frac{1}{Pe_K}\right)$$
Péclet数 $Pe_K = \frac{|\mathbf{a}|h_K}{2\nu}$。</p>
<h4 id="_2">最小二乘稳定化</h4>
<p>对于混合问题，满足inf-sup条件的替代方案：
$$a_{LS}(\mathbf{u}_h, \mathbf{v}_h) = a(\mathbf{u}_h, \mathbf{v}_h) + \sum_K \delta_K (\mathcal{L}\mathbf{u}_h, \mathcal{L}\mathbf{v}_h)_{L^2(K)}$$</p>
<h3 id="617">6.1.7 自适应网格细化</h3>
<h4 id="_3">误差指示子与标记策略</h4>
<p>Dörfler标记：选择最小单元集合 $\mathcal{M} \subset \mathcal{T}_h$ 使得：
$$\sum_{K \in \mathcal{M}} \eta_K^2 \geq \theta \sum_{K \in \mathcal{T}_h} \eta_K^2$$
典型取 $\theta = 0.5$。</p>
<h4 id="_4">细化与粗化</h4>
<p>最长边二分法保证网格质量：</p>
<ul>
<li>标记需细化的单元</li>
<li>递归标记邻居以保持相容性</li>
<li>执行局部细化</li>
<li>投影解到新网格</li>
</ul>
<p>收敛性保证：存在常数 $\gamma &lt; 1$ 使得：
$$|\mathbf{u} - \mathbf{u}_{h_{n+1}}|_{H^1} \leq \gamma |\mathbf{u} - \mathbf{u}_{h_n}|_{H^1} + \text{高阶项}$$</p>
<h2 id="62">6.2 单元类型：四面体、六面体、高阶单元</h2>
<h3 id="621">6.2.1 四面体单元</h3>
<h4 id="t4">线性四面体（T4）</h4>
<p>参考单元坐标：$(0,0,0)$, $(1,0,0)$, $(0,1,0)$, $(0,0,1)$</p>
<p>形函数：
$$N_1 = 1 - \xi - \eta - \zeta$$
$$N_2 = \xi$$
$$N_3 = \eta$$
$$N_4 = \zeta$$
雅可比矩阵：
$$\mathbf{J} = \begin{bmatrix}
x_2-x_1 &amp; x_3-x_1 &amp; x_4-x_1 \\
y_2-y_1 &amp; y_3-y_1 &amp; y_4-y_1 \\
z_2-z_1 &amp; z_3-z_1 &amp; z_4-z_1
\end{bmatrix}$$
体积：$V = \frac{1}{6}|\det(\mathbf{J})|$</p>
<h4 id="t10">二次四面体（T10）</h4>
<p>增加6个中节点，形函数包含二次项：
$$N_i = (2L_i - 1)L_i \quad \text{(角节点)}$$
$$N_{ij} = 4L_i L_j \quad \text{(边中点)}$$
其中 $L_i$ 是体积坐标。</p>
<h3 id="622">6.2.2 六面体单元</h3>
<h4 id="h8">线性六面体（H8）</h4>
<p>参考单元：$[-1,1]^3$</p>
<p>形函数：
$$N_i(\xi, \eta, \zeta) = \frac{1}{8}(1 + \xi_i\xi)(1 + \eta_i\eta)(1 + \zeta_i\zeta)$$
等参变换：
$$\mathbf{x} = \sum_{i=1}^8 N_i(\boldsymbol{\xi}) \mathbf{x}_i$$</p>
<h4 id="h20h27">二次六面体（H20/H27）</h4>
<p>Serendipity单元（H20）：仅边中点，无面心和体心
$$N_i = \frac{1}{8}(1+\xi_i\xi)(1+\eta_i\eta)(1+\zeta_i\zeta)(\xi_i\xi+\eta_i\eta+\zeta_i\zeta-2)$$
Lagrange单元（H27）：完全二次，包含所有节点</p>
<h3 id="623">6.2.3 高阶谱单元</h3>
<h4 id="legendre">Legendre基函数</h4>
<p>一维Legendre多项式递推：
$$P_0(x) = 1, \quad P_1(x) = x$$
$$P_{n+1}(x) = \frac{2n+1}{n+1}xP_n(x) - \frac{n}{n+1}P_{n-1}(x)$$
三维张量积基：
$$\phi_{ijk}(\xi, \eta, \zeta) = P_i(\xi)P_j(\eta)P_k(\zeta)$$</p>
<h4 id="hierarchical">分层基函数（Hierarchical）</h4>
<p>边模式、面模式、体模式的分离：</p>
<ul>
<li>顶点模式：线性形函数</li>
<li>边模式：$\phi_e^p = \frac{1-\xi^2}{4}P_{p-2}'(\xi)$</li>
<li>面模式：$\phi_f^{pq} = \frac{(1-\xi^2)(1-\eta^2)}{16}P_{p-2}'(\xi)P_{q-2}'(\eta)$</li>
</ul>
<h3 id="624">6.2.4 锁定现象与缓解策略</h3>
<h4 id="_5">体积锁定（不可压缩材料）</h4>
<p>当泊松比 $\nu \to 0.5$，体积模量 $K \to \infty$</p>
<p>B-bar方法：修正应变-位移矩阵
$$\bar{\mathbf{B}} = \mathbf{B}_{dev} + \frac{1}{3}\bar{\mathbf{B}}_{vol}$$
其中 $\bar{\mathbf{B}}_{vol}$ 使用降阶积分计算。</p>
<h4 id="_6">剪切锁定（薄结构）</h4>
<p>减缩积分：使用较少的Gauss点</p>
<ul>
<li>完全积分：$(p+1)^3$ 个Gauss点</li>
<li>减缩积分：$p^3$ 个Gauss点</li>
</ul>
<p>沙漏控制：添加稳定项防止零能模式
$$\mathbf{K}_{stab} = \alpha \mathbf{K}_{hourglass}$$</p>
<h3 id="625">6.2.5 单元质量评估</h3>
<h4 id="_7">雅可比比率</h4>
<p>$$\rho_J = \frac{\min_{\xi \in \Omega_e} \det(\mathbf{J})}{\max_{\xi \in \Omega_e} \det(\mathbf{J})}$$
理想值：$\rho_J = 1$（均匀变形）</p>
<h4 id="aspect-ratio">长宽比（Aspect Ratio）</h4>
<p>$$AR = \frac{\max(l_i)}{\min(l_i)}$$
其中 $l_i$ 是单元边长。建议 $AR &lt; 10$。</p>
<h4 id="skewness">偏斜度（Skewness）</h4>
<p>$$S = \frac{|V_{actual} - V_{ideal}|}{V_{ideal}}$$
建议 $S &lt; 0.5$ 以保证精度。</p>
<h4 id="_8">条件数估计</h4>
<p>单元刚度矩阵条件数：
$$\kappa(K_e) \sim \left(\frac{\max(l_i)}{\min(l_i)}\right)^2 \cdot \frac{E}{\nu(1-2\nu)}$$
对于畸变单元，条件数急剧增加，导致数值不稳定。</p>
<h3 id="626-p-hp-fem">6.2.6 p-自适应与hp-FEM</h3>
<h4 id="_9">误差指示子</h4>
<p>基于Legendre展开的误差估计：
$$\eta_p = |u_p - u_{p-1}|_{H^1(K)}$$
谱收敛率：对于解析函数
$$|u - u_p|_{H^1} \leq C e^{-\alpha p}$$</p>
<h4 id="hp-">hp-决策准则</h4>
<p>光滑度指示子：
$$\sigma_K = \frac{|u_p - u_{p-1}|_{L^2(K)}}{|u_p - u_{p-2}|_{L^2(K)}}$$</p>
<ul>
<li>若 $\sigma_K &gt; \theta_p$：p-细化（解光滑）</li>
<li>若 $\sigma_K &lt; \theta_h$：h-细化（解有奇异性）</li>
</ul>
<h3 id="627">6.2.7 积分规则与精度</h3>
<h4 id="gauss-legendre">Gauss-Legendre积分</h4>
<p>$n$ 点规则精确积分 $2n-1$ 阶多项式：</p>
<p>| 积分点数 | 位置 $\xi_i$ | 权重 $w_i$ |</p>
<table>
<thead>
<tr>
<th>积分点数</th>
<th>位置 $\xi_i$</th>
<th>权重 $w_i$</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>0</td>
<td>2</td>
</tr>
<tr>
<td>2</td>
<td>$\pm 1/\sqrt{3}$</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>0, $\pm\sqrt{3/5}$</td>
<td>8/9, 5/9</td>
</tr>
</tbody>
</table>
<p>三维张量积：$(n_{Gauss})^3$ 个积分点</p>
<h4 id="_10">积分精度要求</h4>
<p>刚度矩阵积分：至少 $2p-1$ 阶精度（$p$ 为基函数阶数）
质量矩阵积分：至少 $2p$ 阶精度
非线性项：根据非线性度自适应选择</p>
<h2 id="63">6.3 刚度矩阵组装与边界条件</h2>
<h3 id="631">6.3.1 局部到全局映射</h3>
<h4 id="_11">自由度编号</h4>
<p>节点自由度映射：
$$\text{DOF}_{global} = \text{ndof} \times (\text{node_id} - 1) + \text{dof_component}$$
其中 $\text{ndof}$ 是每节点自由度数（如3D弹性为3）。</p>
<h4 id="_12">连接矩阵</h4>
<p>单元 $e$ 的连接矩阵 $\mathbf{L}^e$：
$$\mathbf{u}^e = \mathbf{L}^e \mathbf{u}_{global}$$
稀疏性：$\mathbf{L}^e$ 每行仅一个非零元素1。</p>
<h3 id="632">6.3.2 刚度矩阵组装算法</h3>
<h4 id="_13">单元刚度矩阵计算</h4>
<p>对于单元 $e$：
$$K_{ij}^e = \int_{\Omega_e} \mathbf{B}_i^T \mathbf{D} \mathbf{B}_j \, d\Omega$$
其中应变-位移矩阵：
$$\mathbf{B}_i = \begin{bmatrix}
\frac{\partial N_i}{\partial x} &amp; 0 &amp; 0 \\
0 &amp; \frac{\partial N_i}{\partial y} &amp; 0 \\
0 &amp; 0 &amp; \frac{\partial N_i}{\partial z} \\
\frac{\partial N_i}{\partial y} &amp; \frac{\partial N_i}{\partial x} &amp; 0 \\
0 &amp; \frac{\partial N_i}{\partial z} &amp; \frac{\partial N_i}{\partial y} \\
\frac{\partial N_i}{\partial z} &amp; 0 &amp; \frac{\partial N_i}{\partial x}
\end{bmatrix}$$
弹性矩阵 $\mathbf{D}$ （各向同性）：
$$\mathbf{D} = \frac{E}{(1+\nu)(1-2\nu)} \begin{bmatrix}
1-\nu &amp; \nu &amp; \nu &amp; 0 &amp; 0 &amp; 0 \\
\nu &amp; 1-\nu &amp; \nu &amp; 0 &amp; 0 &amp; 0 \\
\nu &amp; \nu &amp; 1-\nu &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; \frac{1-2\nu}{2} &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \frac{1-2\nu}{2} &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \frac{1-2\nu}{2}
\end{bmatrix}$$</p>
<h4 id="_14">组装过程</h4>
<p>全局刚度矩阵：
$$\mathbf{K} = \sum_{e=1}^{n_{elem}} (\mathbf{L}^e)^T \mathbf{K}^e \mathbf{L}^e$$
稀疏存储格式：</p>
<ul>
<li>CSR (Compressed Sparse Row)：行压缩存储</li>
<li>COO (Coordinate)：坐标格式，便于并行组装</li>
<li>Skyline：利用带宽结构</li>
</ul>
<h3 id="633">6.3.3 边界条件处理</h3>
<h4 id="dirichlet">Dirichlet边界条件</h4>
<p><strong>罚函数法</strong>：
$$\mathbf{K}_{modified} = \mathbf{K} + \alpha \mathbf{P}$$
其中 $\mathbf{P}_{ii} = 1$ 若节点 $i$ 受约束，$\alpha \sim 10^{10} \max(K_{ii})$。</p>
<p><strong>Lagrange乘子法</strong>：
$$\begin{bmatrix}
\mathbf{K} &amp; \mathbf{G}^T \\
\mathbf{G} &amp; \mathbf{0}
\end{bmatrix} \begin{bmatrix}
\mathbf{u} \\
\boldsymbol{\lambda}
\end{bmatrix} = \begin{bmatrix}
\mathbf{f} \\
\mathbf{g}
\end{bmatrix}$$
<strong>消去法</strong>（推荐）：
将自由度分为约束 $(c)$ 和自由 $(f)$：
$$\begin{bmatrix}
\mathbf{K}_{ff} &amp; \mathbf{K}_{fc} \\
\mathbf{K}_{cf} &amp; \mathbf{K}_{cc}
\end{bmatrix} \begin{bmatrix}
\mathbf{u}_f \\
\mathbf{u}_c
\end{bmatrix} = \begin{bmatrix}
\mathbf{f}_f \\
\mathbf{f}_c
\end{bmatrix}$$
求解缩减系统：
$$\mathbf{K}_{ff} \mathbf{u}_f = \mathbf{f}_f - \mathbf{K}_{fc} \mathbf{u}_c$$</p>
<h4 id="neumann">Neumann边界条件</h4>
<p>表面力积分：
$$\mathbf{f}_i = \int_{\Gamma_N} N_i \overline{\mathbf{t}} \, d\Gamma$$
对于线性单元，均布载荷：
$$\mathbf{f}_{node} = \frac{A_{face}}{n_{nodes}} \overline{\mathbf{t}}$$</p>
<h4 id="_15">周期边界条件</h4>
<p>主从节点约束：
$$\mathbf{u}_{slave} = \mathbf{u}_{master} + \boldsymbol{\Delta}$$
通过约束矩阵 $\mathbf{C}$ 实现：
$$\mathbf{C} \mathbf{u} = \mathbf{d}$$</p>
<h3 id="634">6.3.4 求解器选择</h3>
<h4 id="_16">直接求解器</h4>
<p><strong>LU分解</strong>：
$$\mathbf{K} = \mathbf{L}\mathbf{U}$$
复杂度：$O(n^3)$ （密集），$O(n^{3/2})$ （2D稀疏），$O(n^2)$ （3D稀疏）</p>
<p><strong>Cholesky分解</strong>（对称正定）：
$$\mathbf{K} = \mathbf{L}\mathbf{L}^T$$
存储和计算减半。</p>
<h4 id="_17">迭代求解器</h4>
<p><strong>共轭梯度法（CG）</strong>：
适用于对称正定系统，收敛率：
$$|\mathbf{e}_k|_{\mathbf{K}} \leq 2\left(\frac{\sqrt{\kappa}-1}{\sqrt{\kappa}+1}\right)^k |\mathbf{e}_0|_{\mathbf{K}}$$
<strong>预条件</strong>：</p>
<ul>
<li>Jacobi：$\mathbf{M} = \text{diag}(\mathbf{K})$</li>
<li>ILU(0)：不完全LU分解</li>
<li>AMG：代数多重网格</li>
</ul>
<h3 id="635">6.3.5 并行化策略</h3>
<h4 id="_18">域分解</h4>
<p>非重叠域分解（Schur补）：
$$\mathbf{S} = \mathbf{K}_{\Gamma\Gamma} - \mathbf{K}_{\Gamma I} \mathbf{K}_{II}^{-1} \mathbf{K}_{I\Gamma}$$
其中 $\Gamma$ 是界面，$I$ 是内部。</p>
<h4 id="feti">FETI方法</h4>
<p>Lagrange乘子强制界面连续性：
$$\sum_{s=1}^{n_s} \mathbf{B}^{(s)} \mathbf{u}^{(s)} = \mathbf{0}$$
对偶问题：
$$\mathbf{F}\boldsymbol{\lambda} = \mathbf{d}$$</p>
<p>其中 $\mathbf{F} = \sum_s \mathbf{B}^{(s)} \mathbf{K}^{(s)+} \mathbf{B}^{(s)T}$。</p>
            </article>
            
            <nav class="page-nav"><a href="./chapter5.html" class="nav-link prev">← 第5章：网格处理算法</a><a href="./chapter7.html" class="nav-link next">第7章：拓扑优化基础 →</a></nav>
        </main>
    </div>
</body>
</html>